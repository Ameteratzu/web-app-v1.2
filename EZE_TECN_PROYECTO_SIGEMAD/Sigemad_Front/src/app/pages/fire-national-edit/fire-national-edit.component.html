<div class="d-flex border-bottom">
  <div class="w-50">
    <h1 class="text-info font-weight-bold font-size-48 calibri">
      Sistema de gestión de emergencia <br />
      y apoyo a la decisión
    </h1>
  </div>

  <div class="w-50 text-right">
    <h1 class="text-blue font-weight-bold inter mt-20">Incendios forestales</h1>

    <h2 class="text-green font-weight-bold inter">Búsqueda de sucesos</h2>
  </div>
</div>

<form (ngSubmit)="onSubmit()" [formGroup]="formData">
  <input type="hidden" formControlName="id" value="{{ fire.id }}" />
  <input
    type="hidden"
    formControlName="territory"
    value="{{ fire.idTerritorio }}"
  />

  <div class="d-flex pt-15 justify-content-between mr-20">
    <div class="d-flex">
      <div class="pt-12 pe-15 inter font-weight-bold font-size-16">
        Denominación
      </div>

      <div>
        <input
          formControlName="name"
          value="{{ fire.denominacion }}"
          class="form-control"
          type="text"
          placeholder="Santa María de Guía de Gran Canaría"
        />
      </div>
    </div>

    <div class="d-flex">
      <div class="pt-12 pe-15 inter font-weight-bold font-size-16">
        Provincia
      </div>

      <div>
        <select
          formControlName="province"
          class="form-control"
          (change)="loadMunicipalities($event)"
        >
          <option value=""></option>
          <option
            [selected]="province.id == fire.idProvincia"
            value="{{ province.id }}"
            *ngFor="let province of provinces()"
          >
            {{ province.descripcion }}
          </option>
        </select>
      </div>
    </div>

    <div class="d-flex">
      <div class="pt-12 font-size-16 pe-15 inter font-weight-bold">
        Municipio
      </div>

      <div>
        <select formControlName="municipality" class="form-control">
          <option value=""></option>
          <option
            [selected]="municipality.id == fire.idMunicipio"
            value="{{ municipality.id }}"
            *ngFor="let municipality of municipalities()"
          >
            {{ municipality.descripcion }}
          </option>
        </select>
      </div>

      <div class="ms-10">
        <img
          (click)="openModalMapEdit()"
          style="cursor: pointer"
          src="/assets/img/location-btn.svg"
          alt="location-btn"
        />
      </div>
    </div>

    <div class="d-flex">
      <div class="pt-12 font-size-16 pe-15 inter font-weight-bold">Inicio</div>

      <div>
        <input
          class="form-control"
          formControlName="start"
          type="datetime-local"
          value="{{ fire.fechaInicio }}"
        />
      </div>
    </div>
  </div>

  <div class="d-flex pt-15 gap-50 justify-content-between mr-20">
    <div class="d-flex">
      <div class="pt-12 font-size-16 pe-15 inter font-weight-bold">
        Tipo de suceso
      </div>

      <div>
        <select formControlName="event" class="form-control">
          <option value=""></option>
          <option
            [selected]="event.id == fire.idSuceso"
            value="{{ event.id }}"
            *ngFor="let event of events()"
          >
            {{ event.descripcion }}
          </option>
        </select>
      </div>
    </div>

    <div class="d-flex">
      <div class="pt-12 font-size-16 pe-15 inter font-weight-bold">
        Nota general
      </div>

      <div class="d-flex">
        <textarea
          formControlName="note"
          class="form-control"
          rows="1"
          cols="134"
          >{{ fire.comentarios }}</textarea
        >

        <button class="btn-white">
          <img src="/assets/img/arrow-expand.svg" alt="arrow-expand" />
        </button>
      </div>
    </div>
  </div>

  <div
    class="border-bottom text-right me-20 pt-15 pb-15 d-flex justify-content-between"
  >
    <div class="d-flex">
      <div class="pt-12 font-size-16 pe-15 inter font-weight-bold">Estado</div>

      <div>
        <select formControlName="event" class="form-control">
          <option value=""></option>
          <option
            [selected]="status.id == fire.idEstado"
            value="{{ status.id }}"
            *ngFor="let status of fireStatus()"
          >
            {{ status.descripcion }}
          </option>
        </select>
      </div>
    </div>

    <div class="text-right">
      <button type="submit" class="btn-blue">
        <img class="w-30 h-30" src="/assets/img/check.svg" alt="check" />
      </button>

      <button type="button" class="btn-white">
        <img class="w-30 h-30" src="/assets/img/list-btn.svg" alt="list-btn" />
      </button>

      <button (click)="confirmDelete()" type="button" class="btn-white">
        <img class="w-30 h-30" src="/assets/img/close.svg" alt="close" />
      </button>

      <button type="button" class="btn-white">
        <img class="w-30 h-30" src="/assets/img/refresh.svg" alt="refresh" />
      </button>

      <button type="button" class="btn-white">
        <img class="w-30 h-30" src="/assets/img/back.svg" alt="back" />
      </button>
    </div>
  </div>
</form>

<div class="me-20 mt-5">
  <img class="w-100" src="/assets/img/graph.svg" alt="graph" />
</div>

<hr class="me-20" />

<div class="d-flex mb-100">
  <div class="border p-5 mr-13 w-25p">
    <div class="d-flex justify-content-between">
      <div>
        <span class="font-size-20 text-blue font-weight-bold"
          >Datos consolidados</span
        >
        (Act: 19/08/2024 19:45)
      </div>

      <div>
        <img src="/assets/img/doc-btn.svg" alt="doc-btn" />
      </div>
    </div>

    <div class="mt-24">
      <span class="font-weight-bold">Inicio de incendio</span>
      {{ fire.fechaInicio }}
    </div>

    <div>
      <span class="font-weight-bold">Estado</span>
      {{ fire.estadoSuceso.descripcion }}
    </div>

    <div><span class="font-weight-bold">Nivel de gravedad</span> Activo</div>

    <div class="mt-25">
      <span class="font-weight-bold">Hechos relevantes</span>
    </div>

    <div>Activado plan nacional XX (18/08/2024 10:00)</div>
    <div>Activado Coppernico (18/08/2024 12:00)</div>
    <div>CECOPI (19/08/2024 18:15)</div>

    <div class="mt-25">
      <span class="font-weight-bold">Consecuencias</span>
    </div>

    <div>Heridos: 2</div>
    <div>Evacuados: 134 (Santa María - 18/08/2024 19:45)</div>
    <div>Area afectada: Santa María de Guía de Gran Canaria</div>
    <div>Viabilidad: Corte CN-21 PK 2,300-3,100</div>

    <div class="mt-25">
      <span class="font-weight-bold">Medios intervinientes</span>
    </div>

    <div>Ordinarios: BRIF/A - Tineo (18/08/2024 12:40)</div>
    <div>Ordinarios: FOCA - Torrejon (18/08/2024 16:35)</div>
    <div>Extraordinarios: UME - Aprobación (19/08/2024 19:15)</div>
  </div>

  <div class="border p-5 w-90">
    <div *ngIf="showUpdateLog">
      <div class="d-flex justify-content-between pt-10">
        <div>
          <img
            (click)="showTable('showDetailsUpdate')"
            class="cursor-pointer"
            src="/assets/img/doc-btn.svg"
            alt="doc-btn"
          />
          <span class="font-size-20 text-blue font-weight-bold"
            >Registro de actualizaciones</span
          >
          (Cantidad: 10 - Orden Fecha y hora desc.)
        </div>

        <div>
          <a
            (click)="openModalEvolution()"
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8 cursor-pointer"
            >E</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8 cursor-pointer"
            >C</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8 cursor-pointer"
            >R</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8 cursor-pointer"
            >D</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8 cursor-pointer"
            >O</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8 cursor-pointer"
            >S</a
          >

          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8 cursor-pointer"
          >
            <img src="/assets/img/doc-btn.svg" height="20px" alt="doc-btn" />
          </a>
        </div>
      </div>

      <table class="w-100 mt-15">
        <thead>
          <tr>
            <th>No.</th>
            <th>Fecha y hora</th>
            <th>Registro</th>
            <th>Origen</th>
            <th>Tipo de registro</th>
            <th>Técnico</th>
            <th></th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let log of logs().splice(0, 10); let no = index">
            <td>{{ no + 1 }}</td>
            <td>{{ log.fechaRegistro }}</td>
            <td>{{ log.registro }}</td>
            <td>{{ log.origen }}</td>
            <td>{{ log.tipoRegistro }}</td>
            <td>{{ log.tecnico }}</td>

            <td>
              <a
                class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
              >
                <img
                  src="/assets/img/options.png"
                  width="30px"
                  alt="option-btn"
                />
              </a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="showDetailsUpdate">
      <div class="d-flex justify-content-between pt-10">
        <div>
          <img
            (click)="showTable('showUpdateLog')"
            class="cursor-pointer"
            src="/assets/img/doc-btn.svg"
            alt="doc-btn"
          />
          <span class="font-size-20 text-blue font-weight-bold"
            >Detalle de las actualizaciones</span
          >
          (Cantidad: 10 - Orden Fecha y hora desc.)
        </div>

        <div>
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
            >E</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
            >C</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
            >R</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
            >D</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
            >O</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
            >S</a
          >

          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
          >
            <img src="/assets/img/doc-btn.svg" height="20px" alt="doc-btn" />
          </a>
        </div>
      </div>

      <table class="w-100 mt-15">
        <thead>
          <tr>
            <th>Reg</th>
            <th>Fecha y hora</th>
            <th>Ámbito</th>
            <th>Tipo</th>
            <th>Implicación</th>
            <th></th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let detail of details">
            <td>{{ detail.reg }}</td>
            <td>{{ detail.datetime }}</td>
            <td>{{ detail.scope }}</td>
            <td>{{ detail.type }}</td>
            <td>{{ detail.implication }}</td>

            <td>
              <a
                class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
              >
                <img
                  src="/assets/img/options.png"
                  width="30px"
                  alt="option-btn"
                />
              </a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
