<div class="d-flex justify-content-between">
  <div class="w-50">
    <h1 class="text-info font-weight-bold font-size-32 calibri">
      Sistema de Gestión de Emergencia <br />
      y Apoyo a la Decisión
    </h1>
  </div>

  <div class="text-right">
    <h1 class="text-blue font-weight-bold inter font-size-24 mt-18">
      Incendios forestales
    </h1>

    <h2 class="text-green inter font-size-20 font-weight-500">
      Búsqueda de sucesos
    </h2>
  </div>
</div>
<hr style="margin-top: 10px" />

<form (ngSubmit)="onSubmit()" [formGroup]="formData">
  <input type="hidden" formControlName="id" value="{{ fire.id }}" />

  <input
    type="hidden"
    formControlName="territory"
    value="{{ fire.idTerritorio }}"
  />

  <div class="d-flex pt-15 gap8 mr-20">
    <div class="d-flex w-full">
      <div class="child w-full d-flex">
        <div class="inter p-12 font-weight-bold font-size-16 font-color-grey">
          Denominación
        </div>

        <input
          type="text"
          pInputText
          formControlName="denomination"
          placeholder=""
          value="{{ fire.denominacion }}"
          class="inputText child w-full"
        />
      </div>
    </div>

    <div class="d-flex w-full">
      <div class="child w-full d-flex">
        <div
          class="pt-12 pe-15 inter font-weight-bold font-size-16 font-color-grey"
        >
          Provincia
        </div>
        <p-dropdown
          emptyMessage=" "
          formControlName="province"
          [options]="provinces()"
          optionLabel="descripcion"
          placeholder="Provincia"
          optionValue="id"
          (onChange)="loadMunicipalities($event)"
          [showClear]="true"
          class="inputText child w-full"
        />
      </div>
    </div>

    <div class="d-flex w-full">
      <div class="child w-full d-flex">
        <div
          class="pt-12 font-size-16 pe-15 inter font-weight-bold font-color-grey"
        >
          Municipio
        </div>

        <p-dropdown
          emptyMessage=" "
          formControlName="municipality"
          [options]="municipalities()"
          optionLabel="descripcion"
          placeholder="Municipios"
          optionValue="id"
          [showClear]="true"
          class="inputText child w-full"
        />

        <div class="ms-10">
          <img
            (click)="openModalMapEdit()"
            style="cursor: pointer"
            src="/assets/img/location-btn.svg"
            alt="location-btn"
          />
        </div>
      </div>
    </div>

    <div class="d-flex w-full">
      <div class="child w-full d-flex">
        <div
          class="pt-12 font-size-16 pe-15 inter font-weight-bold font-color-grey"
        >
          Inicio
        </div>

        <p-calendar
          dateFormat="d/mm/yy"
          formControlName="startDate"
          [iconDisplay]="'input'"
          [showIcon]="true"
          placeholder="Inicio"
          inputId="icondisplay"
          class="inputText child w-full"
        />
      </div>
    </div>
  </div>

  <div class="d-flex pt-15 gap8 mr-20">
    <div class="d-flex w-full">
      <div class="child w-full d-flex">
        <div
          class="pt-12 font-size-16 pe-15 inter font-weight-bold font-color-grey"
        >
          Tipo de suceso
        </div>

        <p-dropdown
          emptyMessage=" "
          formControlName="event"
          [options]="events()"
          optionLabel="descripcion"
          optionValue="id"
          [showClear]="true"
          class="inputText child2 w-full"
        />
      </div>
    </div>

    <div class="d-flex w-full">
      <div class="d-flex w-full">
        <div class="font-size-16 inter font-weight-bold font-color-grey">
          Nota general
        </div>

        <textarea
          rows="1"
          cols="134"
          pInputTextarea
          formControlName="generalNote"
          class="inputText child2 w-full"
        >
        </textarea>
      </div>
    </div>
  </div>

  <div class="border-bottom d-flex pt-15 gap8 mr-20 me-20 pt-15 pb-15">
    <div class="d-flex w-full">
      <div
        class="pt-12 font-size-16 pe-15 inter font-weight-bold font-color-grey"
      >
        Estado de suceso
      </div>

      <p-dropdown
        emptyMessage=" "
        formControlName="idEstado"
        [options]="fireStatus()"
        optionLabel="descripcion"
        optionValue="id"
        [showClear]="true"
        class="inputText child2 w-full"
      />
    </div>
    <div class="d-flex w-full">
      <div class="inputText child2 w-full justify-end">
        <div class="d-flex justify-end">
          <button type="submit" class="btn-blue">
            <img class="w-30 h-30" src="/assets/img/check.svg" alt="check" />
          </button>

          <button type="button" class="btn-white">
            <img
              class="w-30 h-30"
              src="/assets/img/list-btn.svg"
              alt="list-btn"
            />
          </button>

          <button (click)="confirmDelete()" type="button" class="btn-white">
            <img class="w-30 h-30" src="/assets/img/close.svg" alt="close" />
          </button>

          <button (click)="ngOnInit()" type="button" class="btn-white">
            <img
              class="w-30 h-30"
              src="/assets/img/refresh.svg"
              alt="refresh"
            />
          </button>

          <button type="button" (click)="back()" class="btn-white">
            <img class="w-30 h-30" src="/assets/img/back.svg" alt="back" />
          </button>
        </div>
      </div>
    </div>
  </div>
</form>

<div class="me-20 mt-8">
  <img class="w-100" src="/assets/img/graph.svg" alt="graph" />
</div>

<hr class="me-20" />

<div class="d-flex mb-100">
  <div class="border p-16 mr-13 w-30p">
    <div class="d-flex justify-content-between">
      <div>
        <span class="font-size-20 text-blue font-weight-bold inter"
          >Datos consolidados</span
        >
        <span class="font-size-12 inter"> (Act: 19/08/2024 19:45) </span>
      </div>

      <div>
        <img src="/assets/img/doc-btn.svg" alt="doc-btn" />
      </div>
    </div>

    <div class="mt-24">
      <span class="font-weight-bold font-size-16 inter"
        >Inicio de incendio</span
      >
      <span class="font-size-12 inter">
        {{ fire.fechaInicio }}
      </span>
    </div>

    <div class="mt-8">
      <span class="font-weight-bold font-size-16 inter">Estado</span>
      <span class="font-size-12 inter"> {{ getEstadoDesc(fire) }}</span>
    </div>

    <div class="mt-8">
      <span class="font-weight-bold font-size-16 inter">Nivel de gravedad</span>
      <span class="font-size-12 inter"> Activo </span>
    </div>

    <div class="mt-20 container">
      <span class="font-weight-bold font-size-16 inter hechos-relevantes"
        >Hechos relevantes</span
      ><span class="line"> </span>
    </div>
    <div class="ml-20">
      <div class="font-size-12 inter mt-8">
        Activado plan nacional XX (18/08/2024 10:00)
      </div>
      <div class="font-size-12 inter mt-8">
        Activado Coppernico (18/08/2024 12:00)
      </div>
      <div class="font-size-12 inter mt-8">CECOPI (19/08/2024 18:15)</div>
    </div>

    <div class="mt-20 container">
      <span class="font-weight-bold font-size-16 inter">Consecuencias</span>
      <span class="line"> </span>
    </div>
    <div class="ml-20">
      <div class="font-size-12 inter mt-8">Heridos: 2</div>
      <div class="font-size-12 inter mt-8">
        Evacuados: 134 (Santa María - 18/08/2024 19:45)
      </div>
      <div class="font-size-12 inter mt-8">
        Area afectada: Santa María de Guía de Gran Canaria
      </div>
      <div class="font-size-12 inter mt-8">
        Viabilidad: Corte CN-21 PK 2,300-3,100
      </div>
    </div>

    <div class="mt-20 container">
      <span class="font-weight-bold font-size-16 inter"
        >Medios intervinientes</span
      ><span class="line"> </span>
    </div>

    <div class="ml-20">
      <div class="font-size-12 inter mt-8">
        Ordinarios: BRIF/A - Tineo (18/08/2024 12:40)
      </div>
      <div class="font-size-12 inter mt-8">
        Ordinarios: FOCA - Torrejon (18/08/2024 16:35)
      </div>
      <div class="font-size-12 inter mt-8">
        Extraordinarios: UME - Aprobación (19/08/2024 19:15)
      </div>
    </div>
  </div>

  <div class="border p-5 w-90">
    <div *ngIf="showUpdateLog">
      <div class="d-flex justify-content-between pt-10">
        <div>
          <img
            (click)="showTable('showDetailsUpdate')"
            class="cursor-pointer"
            src="/assets/img/doc-btn.svg"
            alt="doc-btn"
          />
          <span class="font-size-20 text-blue font-weight-bold inter"
            >Registro de actualizaciones</span
          >
          <span class="font-size-12">
            (Cantidad: 10 - Orden Fecha y hora desc.)
          </span>
        </div>

        <div>
          <a
            (click)="openModalEvolution()"
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-18 p-8 w-36 mr-8 cursor-pointer"
            >E</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-18 p-8 w-36 mr-8 cursor-pointer"
            >C</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-18 p-8 w-36 mr-8 cursor-pointer"
            >R</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-18 p-8 w-36 mr-8 cursor-pointer"
            >D</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-18 p-8 w-36 mr-8 cursor-pointer"
            >O</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-18 p-8 w-36 mr-8 cursor-pointer"
            >S</a
          >

          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8 cursor-pointer"
          >
            <img src="/assets/img/doc-btn.svg" height="20px" alt="doc-btn" />
          </a>
        </div>
      </div>

      <table class="w-100 mt-15">
        <thead>
          <tr>
            <th class="font-weight-bold font-size-16 inter">
              N° <img src="/assets/img/orderIcon.svg" />
            </th>
            <th class="font-weight-bold font-size-16 inter">Fecha / hora</th>
            <th class="font-weight-bold font-size-16 inter">Registro</th>
            <th class="font-weight-bold font-size-16 inter">Origen</th>
            <th class="font-weight-bold font-size-16 inter">
              Tipo de re-gistro
            </th>
            <th class="font-weight-bold font-size-16 inter">Técnico</th>
            <th></th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let log of logs().splice(0, 10); let no = index">
            <td class="font-size-12 inter p-5 h-48">{{ no + 1 }}</td>
            <td class="font-size-12 inter p-5 h-48">{{ log.fechaRegistro }}</td>
            <td class="font-size-12 inter p-5 h-48">{{ log.registro }}</td>
            <td class="font-size-12 inter p-5 h-48">{{ log.origen }}</td>
            <td class="font-size-12 inter p-5 h-48">{{ log.tipoRegistro }}</td>
            <td class="font-size-12 inter p-5 h-48">{{ log.tecnico }}</td>

            <td>
              <a
                class="border-silver text-secondary-blue border-radius-8 p-5 w-36 mr-8"
              >
                <img
                  src="/assets/img/options.png"
                  width="30px"
                  alt="option-btn"
                />
              </a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="showDetailsUpdate">
      <div class="d-flex justify-content-between pt-10">
        <div>
          <img
            (click)="showTable('showUpdateLog')"
            class="cursor-pointer"
            src="/assets/img/doc-btn.svg"
            alt="doc-btn"
          />
          <span class="font-size-20 text-blue font-weight-bold"
            >Detalle de las actualizaciones</span
          >
          (Cantidad: 10 - Orden Fecha/hora desc.)
        </div>

        <div>
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
            >E</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
            >C</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
            >R</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
            >D</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
            >O</a
          >
          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
            >S</a
          >

          <a
            class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
          >
            <img src="/assets/img/doc-btn.svg" height="20px" alt="doc-btn" />
          </a>
        </div>
      </div>

      <table class="w-100 mt-15">
        <thead>
          <tr>
            <th>Reg</th>
            <th>Fecha y hora</th>
            <th>Ámbito</th>
            <th>Tipo</th>
            <th>Implicación</th>
            <th></th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let detail of details">
            <td>{{ detail.reg }}</td>
            <td>{{ detail.datetime }}</td>
            <td>{{ detail.scope }}</td>
            <td>{{ detail.type }}</td>
            <td>{{ detail.implication }}</td>

            <td>
              <a
                class="border-silver text-secondary-blue font-weight-bold border-radius-8 font-size-20 p-8 w-36 mr-8"
              >
                <img
                  src="/assets/img/options.png"
                  width="30px"
                  alt="option-btn"
                />
              </a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
